/*
URL: https://www.itl.nist.gov/div898/strd/nls/data/hahn1.shtml
NIST/ITL StRD
Dataset Name:  Hahn1             (Hahn1.dat)

File Format:   ASCII
               Starting Values   (lines 41 to  47)
               Certified Values  (lines 41 to  52)
               Data              (lines 61 to 296)

Procedure:     Nonlinear Least Squares Regression

Description:   These data are the result of a NIST study involving
               the thermal expansion of copper.  The response
               variable is the coefficient of thermal expansion, and
               the predictor variable is temperature in degrees
               kelvin.


Reference:     Hahn, T., NIST (197?).
               Copper Thermal Expansion Study.





Data:          1 Response  (y = coefficient of thermal expansion)
               1 Predictor (x = temperature, degrees kelvin)
               236 Observations
               Average Level of Difficulty
               Observed Data

Model:         Rational Class (cubic/cubic)
               7 Parameters (b1 to b7)

               y = (b1+b2*x+b3*x**2+b4*x**3) /
                   (1+b5*x+b6*x**2+b7*x**3)  +  e


          Starting values                  Certified Values

        Start 1     Start 2           Parameter     Standard Deviation
  b1 =   10           1            1.0776351733E+00  1.7070154742E-01
  b2 =   -1          -0.1         -1.2269296921E-01  1.2000289189E-02
  b3 =    0.05        0.005        4.0863750610E-03  2.2508314937E-04
  b4 =   -0.00001    -0.000001    -1.4262662514E-06  2.7578037666E-07
  b5 =   -0.05       -0.005       -5.7609940901E-03  2.4712888219E-04
  b6 =    0.001       0.0001       2.4053735503E-04  1.0449373768E-05
  b7 =   -0.000001   -0.0000001   -1.2314450199E-07  1.3027335327E-08

Residual Sum of Squares:                    1.5324382854E+00
Residual Standard Deviation:                8.1803852243E-02
Degrees of Freedom:                               229
Number of Observations:                           236
*/

const MIN_POINT_DISTANCE = 10

const points = [
  { y: 0.591, x: 24.41 },
  { y: 1.547, x: 34.82 },
  { y: 2.902, x: 44.09 },
  { y: 2.894, x: 45.07 },
  { y: 4.703, x: 54.98 },
  { y: 6.307, x: 65.51 },
  { y: 7.03, x: 70.53 },
  { y: 7.898, x: 75.7 },
  { y: 9.47, x: 89.57 },
  { y: 9.484, x: 91.14 },
  { y: 10.072, x: 96.4 },
  { y: 10.163, x: 97.19 },
  { y: 11.615, x: 114.26 },
  { y: 12.005, x: 120.25 },
  { y: 12.478, x: 127.08 },
  { y: 12.982, x: 133.55 },
  { y: 12.97, x: 133.61 },
  { y: 13.926, x: 158.67 },
  { y: 14.452, x: 172.74 },
  { y: 14.404, x: 171.31 },
  { y: 15.19, x: 202.14 },
  { y: 15.55, x: 220.55 },
  { y: 15.528, x: 221.05 },
  { y: 15.499, x: 221.39 },
  { y: 16.131, x: 250.99 },
  { y: 16.438, x: 268.99 },
  { y: 16.387, x: 271.8 },
  { y: 16.549, x: 271.97 },
  { y: 16.872, x: 321.31 },
  { y: 16.83, x: 321.69 },
  { y: 16.926, x: 330.14 },
  { y: 16.907, x: 333.03 },
  { y: 16.966, x: 333.47 },
  { y: 17.06, x: 340.77 },
  { y: 17.122, x: 345.65 },
  { y: 17.311, x: 373.11 },
  { y: 17.355, x: 373.79 },
  { y: 17.668, x: 411.82 },
  { y: 17.767, x: 419.51 },
  { y: 17.803, x: 421.59 },
  { y: 17.765, x: 422.02 },
  { y: 17.768, x: 422.47 },
  { y: 17.736, x: 422.61 },
  { y: 17.858, x: 441.75 },
  { y: 17.877, x: 447.41 },
  { y: 17.912, x: 448.7 },
  { y: 18.046, x: 472.89 },
  { y: 18.085, x: 476.69 },
  { y: 18.291, x: 522.47 },
  { y: 18.357, x: 522.62 },
  { y: 18.426, x: 524.43 },
  { y: 18.584, x: 546.75 },
  { y: 18.61, x: 549.53 },
  { y: 18.87, x: 575.29 },
  { y: 18.795, x: 576.0 },
  { y: 19.111, x: 625.55 },
  { y: 0.367, x: 20.15 },
  { y: 0.796, x: 28.78 },
  { y: 0.892, x: 29.57 },
  { y: 1.903, x: 37.41 },
  { y: 2.15, x: 39.12 },
  { y: 3.697, x: 50.24 },
  { y: 5.87, x: 61.38 },
  { y: 6.421, x: 66.25 },
  { y: 7.422, x: 73.42 },
  { y: 9.944, x: 95.52 },
  { y: 11.023, x: 107.32 },
  { y: 11.87, x: 122.04 },
  { y: 12.786, x: 134.03 },
  { y: 14.067, x: 163.19 },
  { y: 13.974, x: 163.48 },
  { y: 14.462, x: 175.7 },
  { y: 14.464, x: 179.86 },
  { y: 15.381, x: 211.27 },
  { y: 15.483, x: 217.78 },
  { y: 15.59, x: 219.14 },
  { y: 16.075, x: 262.52 },
  { y: 16.347, x: 268.01 },
  { y: 16.181, x: 268.62 },
  { y: 16.915, x: 336.25 },
  { y: 17.003, x: 337.23 },
  { y: 16.978, x: 339.33 },
  { y: 17.756, x: 427.38 },
  { y: 17.808, x: 428.58 },
  { y: 17.868, x: 432.68 },
  { y: 18.481, x: 528.99 },
  { y: 18.486, x: 531.08 },
  { y: 19.09, x: 628.34 },
  { y: 16.062, x: 253.24 },
  { y: 16.337, x: 273.13 },
  { y: 16.345, x: 273.66 },
  { y: 16.388, x: 282.1 },
  { y: 17.159, x: 346.62 },
  { y: 17.116, x: 347.19 },
  { y: 17.164, x: 348.78 },
  { y: 17.123, x: 351.18 },
  { y: 17.979, x: 450.1 },
  { y: 17.974, x: 450.35 },
  { y: 18.007, x: 451.92 },
  { y: 17.993, x: 455.56 },
  { y: 18.523, x: 552.22 },
  { y: 18.669, x: 553.56 },
  { y: 18.617, x: 555.74 },
  { y: 19.371, x: 652.59 },
  { y: 19.33, x: 656.2 },
  { y: 0.08, x: 14.13 },
  { y: 0.248, x: 20.41 },
  { y: 1.089, x: 31.3 },
  { y: 1.418, x: 33.84 },
  { y: 2.278, x: 39.7 },
  { y: 3.624, x: 48.83 },
  { y: 4.574, x: 54.5 },
  { y: 5.556, x: 60.41 },
  { y: 7.267, x: 72.77 },
  { y: 7.695, x: 75.25 },
  { y: 9.136, x: 86.84 },
  { y: 9.959, x: 94.88 },
  { y: 9.957, x: 96.4 },
  { y: 11.6, x: 117.37 },
  { y: 13.138, x: 139.08 },
  { y: 13.564, x: 147.73 },
  { y: 13.871, x: 158.63 },
  { y: 13.994, x: 161.84 },
  { y: 14.947, x: 192.11 },
  { y: 15.473, x: 206.76 },
  { y: 15.379, x: 209.07 },
  { y: 15.455, x: 213.32 },
  { y: 15.908, x: 226.44 },
  { y: 16.114, x: 237.12 },
  { y: 17.071, x: 330.9 },
  { y: 17.135, x: 358.72 },
  { y: 17.282, x: 370.77 },
  { y: 17.368, x: 372.72 },
  { y: 17.483, x: 396.24 },
  { y: 17.764, x: 416.59 },
  { y: 18.185, x: 484.02 },
  { y: 18.271, x: 495.47 },
  { y: 18.236, x: 514.78 },
  { y: 18.237, x: 515.65 },
  { y: 18.523, x: 519.47 },
  { y: 18.627, x: 544.47 },
  { y: 18.665, x: 560.11 },
  { y: 19.086, x: 620.77 },
  { y: 0.214, x: 18.97 },
  { y: 0.943, x: 28.93 },
  { y: 1.429, x: 33.91 },
  { y: 2.241, x: 40.03 },
  { y: 2.951, x: 44.66 },
  { y: 3.782, x: 49.87 },
  { y: 4.757, x: 55.16 },
  { y: 5.602, x: 60.9 },
  { y: 7.169, x: 72.08 },
  { y: 8.92, x: 85.15 },
  { y: 10.055, x: 97.06 },
  { y: 12.035, x: 119.63 },
  { y: 12.861, x: 133.27 },
  { y: 13.436, x: 143.84 },
  { y: 14.167, x: 161.91 },
  { y: 14.755, x: 180.67 },
  { y: 15.168, x: 198.44 },
  { y: 15.651, x: 226.86 },
  { y: 15.746, x: 229.65 },
  { y: 16.216, x: 258.27 },
  { y: 16.445, x: 273.77 },
  { y: 16.965, x: 339.15 },
  { y: 17.121, x: 350.13 },
  { y: 17.206, x: 362.75 },
  { y: 17.25, x: 371.03 },
  { y: 17.339, x: 393.32 },
  { y: 17.793, x: 448.53 },
  { y: 18.123, x: 473.78 },
  { y: 18.49, x: 511.12 },
  { y: 18.566, x: 524.7 },
  { y: 18.645, x: 548.75 },
  { y: 18.706, x: 551.64 },
  { y: 18.924, x: 574.02 },
  { y: 19.1, x: 623.86 },
  { y: 0.375, x: 21.46 },
  { y: 0.471, x: 24.33 },
  { y: 1.504, x: 33.43 },
  { y: 2.204, x: 39.22 },
  { y: 2.813, x: 44.18 },
  { y: 4.765, x: 55.02 },
  { y: 9.835, x: 94.33 },
  { y: 10.04, x: 96.44 },
  { y: 11.946, x: 118.82 },
  { y: 12.596, x: 128.48 },
  { y: 13.303, x: 141.94 },
  { y: 13.922, x: 156.92 },
  { y: 14.44, x: 171.65 },
  { y: 14.951, x: 190.0 },
  { y: 15.627, x: 223.26 },
  { y: 15.639, x: 223.88 },
  { y: 15.814, x: 231.5 },
  { y: 16.315, x: 265.05 },
  { y: 16.334, x: 269.44 },
  { y: 16.43, x: 271.78 },
  { y: 16.423, x: 273.46 },
  { y: 17.024, x: 334.61 },
  { y: 17.009, x: 339.79 },
  { y: 17.165, x: 349.52 },
  { y: 17.134, x: 358.18 },
  { y: 17.349, x: 377.98 },
  { y: 17.576, x: 394.77 },
  { y: 17.848, x: 429.66 },
  { y: 18.09, x: 468.22 },
  { y: 18.276, x: 487.27 },
  { y: 18.404, x: 519.54 },
  { y: 18.519, x: 523.03 },
  { y: 19.133, x: 612.99 },
  { y: 19.074, x: 638.59 },
  { y: 19.239, x: 641.36 },
  { y: 19.28, x: 622.05 },
  { y: 19.101, x: 631.5 },
  { y: 19.398, x: 663.97 },
  { y: 19.252, x: 646.9 },
  { y: 19.89, x: 748.29 },
  { y: 20.007, x: 749.21 },
  { y: 19.929, x: 750.14 },
  { y: 19.268, x: 647.04 },
  { y: 19.324, x: 646.89 },
  { y: 20.049, x: 746.9 },
  { y: 20.107, x: 748.43 },
  { y: 20.062, x: 747.35 },
  { y: 20.065, x: 749.27 },
  { y: 19.286, x: 647.61 },
  { y: 19.972, x: 747.78 },
  { y: 20.088, x: 750.51 },
  { y: 20.743, x: 851.37 },
  { y: 20.83, x: 845.97 },
  { y: 20.935, x: 847.54 },
  { y: 21.035, x: 849.93 },
  { y: 20.93, x: 851.61 },
  { y: 21.074, x: 849.75 },
  { y: 21.085, x: 850.98 },
  { y: 20.935, x: 848.23 },
]
  .sort((a, b) => a.x - b.x)
  .reduce((prev, cur) => {
    if (prev.length === 0) {
      prev.push(cur)
    }

    if (cur.x - prev[prev.length - 1].x > MIN_POINT_DISTANCE) {
      prev.push(cur)
    }

    return prev
  }, [])

export default {
  equation:
    'y = \\frac{C_1+C_2 \\cdot x+C_3 \\cdot x^2+C_4 \\cdot x^3}{1+C_5 \\cdot x+C_6 \\cdot x^2+C_7 \\cdot x^3}',
  inputs: ['x'],
  outputs: ['y'],
  points,
}
